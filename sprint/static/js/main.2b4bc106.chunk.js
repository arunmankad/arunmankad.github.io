(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{131:function(t,e,a){t.exports=a(311)},136:function(t,e,a){},166:function(t,e,a){},168:function(t,e,a){},170:function(t,e,a){},172:function(t,e,a){},174:function(t,e,a){},311:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),i=a(56),s=a.n(i),o=(a(136),a(62)),l=a(63),c=a(114),u=a(115),f=a(129),m=a(116),d=a(130),p=a(28),h=a(117),b=(a(166),a(168),function(t){return console.log("PROPS",t),r.a.createElement("div",{className:"Team"},r.a.createElement("div",null,r.a.createElement("p",null,"Enter your PAT!"),r.a.createElement("input",{type:"password"}),r.a.createElement("button",null,"Submit")))}),g=(a(170),function(t){console.log("PROPS",t);return r.a.createElement("div",{className:"Team"},r.a.createElement("div",null,r.a.createElement("h3",null," Teams ! ")),r.a.createElement("div",{className:"container-2"},t.teams.value.map(function(e,a){return r.a.createElement("div",{className:"container-2-box",key:a,onClick:t.click.bind(void 0,a)},r.a.createElement("section",{className:"teamSection"},r.a.createElement("h3",null,e.name),r.a.createElement("p",null,e.description)),r.a.createElement(p.d,{className:"teamIcon",size:"3em"}))})))}),k=(a(172),a(81)),w=function(t){return console.log("PROPS",t),r.a.createElement("div",{className:"Team"},r.a.createElement("div",null,r.a.createElement("p",null,"Iterations...")),r.a.createElement("div",{className:"container-2"},0!==t.iterations.value.length?t.iterations.value.map(function(e,a){return r.a.createElement("div",{className:"container-2-box",key:a,onClick:t.click.bind(void 0,a)},r.a.createElement("section",{className:"teamSection"},r.a.createElement("p",null,e.name),r.a.createElement("p",null,"Start:",k(e.attributes.startDate).format("MMM Do YY")),r.a.createElement("p",null,"End:",k(e.attributes.finishDate).format("MMM Do YY")),r.a.createElement("p",null,e.attributes.timeFrame)),r.a.createElement(p.b,{className:"iterationIcon",size:"3em"}))}):r.a.createElement("p",null,"No Data!")))},E=a(315),S=a(317),v=a(316),D=a(308),y=a(309),A=a(313),N=a(312),H=(a(174),function(t){console.log("PROPS",t);var e,n=a(82);return e=t.burnDown,r.a.createElement("div",{className:"Team"},r.a.createElement("div",{className:"sprintHeader"},r.a.createElement("div",{className:"sprintHeaderLine"},r.a.createElement("p",null,"Status of ",t.currentSprint.sprint.name,"!"),r.a.createElement("p",null,"Completion:","future"!==t.currentSprint.sprint.attributes.timeFrame?isNaN((12*t.currentSprint.totalSprintEffort-t.currentSprint.totalRemainingHoursForSprint)/(12*t.currentSprint.totalSprintEffort)*100)?null:n.up((12*t.currentSprint.totalSprintEffort-t.currentSprint.totalRemainingHoursForSprint)/(12*t.currentSprint.totalSprintEffort)*100,2)+"%":"0%"),r.a.createElement("p",null,"Total SPs:",t.currentSprint.totalSprintEffort)),0!==t.burnDown.length?r.a.createElement(E.a,{width:"100%",aspect:4},r.a.createElement(S.a,{data:e,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement(v.a,{strokeDasharray:"3 3"}),r.a.createElement(D.a,{dataKey:"date"}),r.a.createElement(y.a,null),r.a.createElement(A.a,null),r.a.createElement(N.a,{type:"monotone",dataKey:"work",stroke:"#2b7a78",fill:"#2b7a78"}))):null),r.a.createElement("div",{className:"container-2"},Object.keys(t.currentSprint.pbis).map(function(e,a){return r.a.createElement("div",{className:"container-pbi-box",key:a},r.a.createElement("div",{className:"effort"},t.currentSprint.pbis[e].effort),r.a.createElement("section",null,r.a.createElement("p",null,"PBI#:",e)),"future"!==t.currentSprint.sprint.attributes.timeFrame?0!==t.currentSprint.pbis[e].effort&&void 0!==t.currentSprint.pbis[e].effort?n.up((12*t.currentSprint.pbis[e].effort-t.currentSprint.pbis[e].totalRemainingHours)/(12*t.currentSprint.pbis[e].effort)*100,2)+"%":"NA":"0%")})))}),O=a(81),I=a(310),R=a(82),T=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(f.a)(this,Object(m.a)(e).call(this,t))).fetchAgain=function(t,e){fetch(t,{headers:a.state.headers}).then(function(t){return t.json()}).then(function(t){console.log("JSON",t),"sprint"===e?(a.setState({sprintDetailsLoaded:!0,sprint:t,currentDisplay:"sprint"}),a.fetchBurnDownData("https://otis-app-fe-iaa-dev.azurewebsites.net/api/Redis?key="+t.name),a.fetchAgain(a.state.sprint._links.workitems.href,"workitems")):"workitems"===e?(a.setState({workItemsLoaded:!0,workItems:t,currentDisplay:"workitems"}),a.processWorkItemHandler()):"iterations"===e&&a.setState({iterationAreLoaded:!0,iterations:t,currentDisplay:"iterations",loading:!1})})},a.fetchEffort=function(t){fetch(t,{headers:a.state.headers}).then(function(t){return t.json()}).then(function(t){console.log("EFFORT",t);var e=Object(l.a)({},a.state.pbis);e[t.id].effort=t.fields["Microsoft.VSTS.Scheduling.Effort"],e[t.id].state=t.fields["System.State"],a.setState({pbis:e,countOfPbisWithEffort:a.state.countOfPbisWithEffort+1}),a.calculateCompletion()})},a.fetchRemainingHours=function(t){fetch(t,{headers:a.state.headers}).then(function(t){return t.json()}).then(function(t){console.log("REMAINING HOURS",t);var e=Object(l.a)({},a.state.tasks);e[t.id].remainingHours=t.fields["Microsoft.VSTS.Scheduling.RemainingWork"],e[t.id].state=t.fields["System.State"],a.setState({tasks:e,countOfTaskWithEffort:a.state.countOfTaskWithEffort+1}),a.calculateCompletion()})},a.fetchBurnDownData=function(t){fetch(t).then(function(t){return console.log("%%%%%%%%%%%%%%%%%%%%%% -",t),null===t&&(t={data:[]}),t.json()}).then(function(t){null!==t&&void 0!==t?(console.log("DATATATATATA -",t.data),null===t.data&&(t.data=[]),a.setState({burnDown:t.data})):a.setState({burnDown:[]})})},a.postBurnDown=function(t,e){fetch("https://otis-app-fe-iaa-dev.azurewebsites.net/api/cache?key="+t+"&expiry=43200000",{method:"post",body:JSON.stringify({data:e}),headers:{"Content-Type":"application/json"}}).then(function(e){a.fetchBurnDownData("https://otis-app-fe-iaa-dev.azurewebsites.net/api/Redis?key="+t)})},a.processWorkItemHandler=function(){for(var t={},e={},n=0;n<a.state.workItems.workItemRelations.length;n++)if(null===a.state.workItems.workItemRelations[n].rel){0;var r={};r.id=a.state.workItems.workItemRelations[n].target.id,r.url=a.state.workItems.workItemRelations[n].target.url,t[r.id]=r}else if("System.LinkTypes.Hierarchy-Forward"===a.state.workItems.workItemRelations[n].rel){var i={};i.id=a.state.workItems.workItemRelations[n].target.id,i.url=a.state.workItems.workItemRelations[n].target.url,i.source=a.state.workItems.workItemRelations[n].source.id,e[i.id]=i}console.log("PBIS",t),console.log("TASKS",e),a.setState({currentDisplay:"pbis",pbis:t,tasks:e,loading:!1}),a.findEffortHandlers(),console.log("HAHAHAHAHA",a.state.currentDisplay)},a.findEffortHandlers=function(){Object.keys(a.state.pbis).map(function(t,e){console.log("URL",a.state.pbis[t].url),a.fetchEffort(a.state.pbis[t].url)}),Object.keys(a.state.tasks).map(function(t,e){a.fetchRemainingHours(a.state.tasks[t].url)})},a.calculateCompletion=function(){if(Object.keys(a.state.pbis).length===a.state.countOfPbisWithEffort&&Object.keys(a.state.tasks).length===a.state.countOfTaskWithEffort){var t=0;Object.keys(a.state.pbis).map(function(e){var n=0;t+=isNaN(a.state.pbis[e].effort)?0:a.state.pbis[e].effort,Object.keys(a.state.tasks).map(function(t){a.state.tasks[t].source.toString()===e&&void 0!==a.state.tasks[t].remainingHours&&(n+=isNaN(a.state.tasks[t].remainingHours)?0:a.state.tasks[t].remainingHours)});var r=Object(l.a)({},a.state.pbis);r[e].totalRemainingHours=n,a.setState({pbis:r})});var e=0;Object.keys(a.state.pbis).map(function(t,n){e+=a.state.pbis[t].totalRemainingHours}),a.setState({totalSprintEffort:t,totalRemainingHoursForSprint:e}),a.evaluateBurnDown()}},a.evaluateBurnDown=function(){if("current"===a.state.sprint.attributes.timeFrame){var t=O(),e=t.format("MMM-DD-YY"),n=O(a.state.sprint.attributes.startDate),r=O(a.state.sprint.attributes.finishDate),i=R.up((12*a.state.totalSprintEffort-a.state.totalRemainingHoursForSprint)/(12*a.state.totalSprintEffort)*100,2);console.log("STRT",n.format("MMM Do YY")),console.log("END",r.format("MMM Do YY"));for(var s=O.duration(r.diff(n)).asDays(),l=[],c=0;c<parseInt(s);c++)0===c&&l.push(n.format("MMM-DD-YY")),"Friday"!==n.format("dddd")&&"Saturday"!==n.format("dddd")?l.push(n.add(1,"d").format("MMM-DD-YY")):n.add(1,"d").format("MMM-DD-YY");var u=Object(o.a)(a.state.burnDown);if(console.log("DATES ARRAY",l),0===a.state.burnDown.length&&330===t.utcOffset()){console.log("LENGTH LENGTH -",a.state.burnDown.length),console.log("utcOffset utcOffset -",t.utcOffset());for(var f=0;f<l.length;f++){var m={};m.date=l[f],m.work=0,u.push(m)}a.setState({burnDown:u}),a.postBurnDown(a.state.sprint.name,a.state.burnDown)}else{for(var d=0;d<u.length;d++)u[d].date===e&&330===t.utcOffset()&&(u[d].work=100-i);a.setState({burnDown:u}),a.postBurnDown(a.state.sprint.name,a.state.burnDown)}}},a.teamsClickHandler=function(t){var e="https://dev.azure.com/utcbis/Integrated%20AA/"+a.state.teams.value[t].name+"/_apis/work/teamsettings/iterations?api-version=5.0";a.fetchAgain(e,"iterations"),a.setState({loading:!0})},a.iterationClickHandler=function(t){a.fetchAgain(a.state.iterations.value[t].url,"sprint"),a.setState({loading:!0,selectedIteration:t})},a.resetClickHandler=function(){window.location.reload()},a.tinyAreaChartClickHandler=function(){alert("Details of !!!!!")},a.state={loading:!0,authenticated:!1,headers:{},currentDisplay:"loading",teamsLoaded:!1,teams:{},iterationAreLoaded:!1,iterations:{},selectedIteration:null,sprintDetailsLoaded:!1,sprint:{},workItemsLoaded:!1,workItems:{},pbis:{},tasks:{},countOfPbisWithEffort:0,countOfTaskWithEffort:0,totalSprintEffort:0,totalRemainingHoursForSprint:0,calculateCompletionCallsCountAfterChecking:0,calculateCompletionCallsCountBeforeChecking:0,burnDown:[]},a}return Object(d.a)(e,t),Object(u.a)(e,[{key:"componentDidMount",value:function(){var t=this,e=new Headers;e.set("Authorization","Basic "+I.encode("Basic:kydfboq26hwqsv2bcgclszgmowdt67xppebpuopw57lky2me4jfa")),this.setState({headers:e}),fetch("https://dev.azure.com/utcbis/_apis/projects/2cfbe47b-71d8-4319-a840-e0eccbfb23ef/teams?api-version=5.0",{headers:e}).then(function(e){return console.log("STATUS",e.status),200!==e.status&&t.setState({authenticated:!1,loading:!1}),e.json()}).then(function(e){t.setState({authenticated:!0,loading:!1,teamsLoaded:!0,teams:e,currentDisplay:"teams"})})}},{key:"render",value:function(){if(this.state.loading)return r.a.createElement("div",{className:"sweet-loading"},r.a.createElement(h.HashLoader,{sizeUnit:"px",size:150,color:"#3aafa9",loading:this.state.loading}));var t=null;return t=this.state.authenticated?"teams"===this.state.currentDisplay?r.a.createElement(g,{teams:this.state.teams,click:this.teamsClickHandler.bind(this)}):"iterations"===this.state.currentDisplay?r.a.createElement(w,{iterations:this.state.iterations,click:this.iterationClickHandler.bind(this)}):"pbis"===this.state.currentDisplay?r.a.createElement(H,{burnDown:this.state.burnDown,click:this.tinyAreaChartClickHandler.bind(this),currentSprint:this.state}):null:r.a.createElement(b,null),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(p.a,{className:"appIcon",size:"1.75em"}),r.a.createElement(p.c,{className:"resetIcon",size:"1em",onClick:this.resetClickHandler.bind(this)}),r.a.createElement("p",{className:"headerParagrah"},"IAA daily Sprint status")),t,null)}}]),e}(n.Component),C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(t,e){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var a=t.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}}).catch(function(t){console.error("Error during service worker registration:",t)})}s.a.render(r.a.createElement(T,null),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");C?(function(t,e){fetch(t).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):M(t,e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e,t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):M(e,t)})}}()}},[[131,2,1]]]);
//# sourceMappingURL=main.2b4bc106.chunk.js.map